/*! nanoScrollerJS - v0.7.2
* http://jamesflorentino.github.com/nanoScrollerJS/
* Copyright (c) 2013 James Florentino; Licensed MIT */
(function(g,k,t){var c,l,h,v,d,e,a,n,s,j,w,x,b,m,r,u,i,f,p,o,q;o={paneClass:"pane",sliderClass:"slider",contentClass:"content",iOSNativeScrolling:false,preventPageScrolling:false,disableResize:false,alwaysVisible:false,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null};u="scrollbar";r="scroll";n="mousedown";s="mousemove";w="mousewheel";j="mouseup";m="resize";d="drag";f="up";b="panedown";h="DOMMouseScroll";v="down";p="wheel";e="keydown";a="keyup";i="touchmove";c=k.navigator.appName==="Microsoft Internet Explorer"&&/msie 7./i.test(k.navigator.appVersion)&&k.ActiveXObject;l=null;q=function(){var y,A,z;y=t.createElement("div");A=y.style;A.position="absolute";A.width="100px";A.height="100px";A.overflow=r;A.top="-9999px";t.body.appendChild(y);z=y.offsetWidth-y.clientWidth;t.body.removeChild(y);return z};x=(function(){function y(A,z){this.el=A;this.options=z;l||(l=q());this.$el=g(this.el);this.doc=g(this.options.documentContext||t);this.win=g(this.options.windowContext||k);this.$content=this.$el.children("."+z.contentClass);this.$content.attr("tabindex",0);this.content=this.$content[0];if(this.options.iOSNativeScrolling&&(this.el.style.WebkitOverflowScrolling!=null)){this.nativeScrolling()}else{this.generate()}this.createEvents();this.addEvents();this.reset()}y.prototype.preventScrolling=function(A,z){if(!this.isActive){return}if(A.type===h){if(z===v&&A.originalEvent.detail>0||z===f&&A.originalEvent.detail<0){A.preventDefault()}}else{if(A.type===w){if(!A.originalEvent||!A.originalEvent.wheelDelta){return}if(z===v&&A.originalEvent.wheelDelta<0||z===f&&A.originalEvent.wheelDelta>0){A.preventDefault()}}}};y.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"});this.iOSNativeScrolling=true;this.isActive=true};y.prototype.updateScrollValues=function(){var z;z=this.content;this.maxScrollTop=z.scrollHeight-z.clientHeight;this.contentScrollTop=z.scrollTop;if(!this.iOSNativeScrolling){this.maxSliderTop=this.paneHeight-this.sliderHeight;this.sliderTop=this.contentScrollTop*this.maxSliderTop/this.maxScrollTop}};y.prototype.createEvents=function(){var z=this;this.events={down:function(A){z.isBeingDragged=true;z.offsetY=A.pageY-z.slider.offset().top;z.pane.addClass("active");z.doc.bind(s,z.events[d]).bind(j,z.events[f]);return false},drag:function(A){z.sliderY=A.pageY-z.$el.offset().top-z.offsetY;z.scroll();z.updateScrollValues();if(z.contentScrollTop>=z.maxScrollTop){z.$el.trigger("scrollend")}else{if(z.contentScrollTop===0){z.$el.trigger("scrolltop")}}return false},up:function(A){z.isBeingDragged=false;z.pane.removeClass("active");z.doc.unbind(s,z.events[d]).unbind(j,z.events[f]);return false},resize:function(A){z.reset()},panedown:function(A){z.sliderY=(A.offsetY||A.originalEvent.layerY)-(z.sliderHeight*0.5);z.scroll();z.events.down(A);return false},scroll:function(A){if(z.isBeingDragged){return}z.updateScrollValues();if(!z.iOSNativeScrolling){z.sliderY=z.sliderTop;z.slider.css({top:z.sliderTop})}if(A==null){return}if(z.contentScrollTop>=z.maxScrollTop){if(z.options.preventPageScrolling){z.preventScrolling(A,v)}z.$el.trigger("scrollend")}else{if(z.contentScrollTop===0){if(z.options.preventPageScrolling){z.preventScrolling(A,f)}z.$el.trigger("scrolltop")}}},wheel:function(A){if(A==null){return}z.sliderY+=-A.wheelDeltaY||-A.delta;z.scroll();return false}}};y.prototype.addEvents=function(){var z;this.removeEvents();z=this.events;if(!this.options.disableResize){this.win.bind(m,z[m])}if(!this.iOSNativeScrolling){this.slider.bind(n,z[v]);this.pane.bind(n,z[b]).bind(""+w+" "+h,z[p])}this.$content.bind(""+r+" "+w+" "+h+" "+i,z[r])};y.prototype.removeEvents=function(){var z;z=this.events;this.win.unbind(m,z[m]);if(!this.iOSNativeScrolling){this.slider.unbind();this.pane.unbind()}this.$content.unbind(""+r+" "+w+" "+h+" "+i,z[r])};y.prototype.generate=function(){var B,C,A,z,D;A=this.options;z=A.paneClass,D=A.sliderClass,B=A.contentClass;if(!this.$el.find(""+z).length&&!this.$el.find(""+D).length){this.$el.append('<div class="'+z+'"><div class="'+D+'" /></div>')}this.pane=this.$el.children("."+z);this.slider=this.pane.find("."+D);if(l){C=this.$el.css("direction")==="rtl"?{left:-l}:{right:-l};this.$el.addClass("has-scrollbar")}if(C!=null){this.$content.css(C)}return this};y.prototype.restore=function(){this.stopped=false;this.pane.show();this.addEvents()};y.prototype.reset=function(){var F,G,H,A,B,z,D,C,E;if(this.iOSNativeScrolling){this.contentHeight=this.content.scrollHeight;return}if(!this.$el.find("."+this.options.paneClass).length){this.generate().stop()}if(this.stopped){this.restore()}F=this.content;H=F.style;A=H.overflowY;if(c){this.$content.css({height:this.$content.height()})}G=F.scrollHeight+l;z=this.pane.outerHeight();C=parseInt(this.pane.css("top"),10);B=parseInt(this.pane.css("bottom"),10);D=z+C+B;E=Math.round(D/G*D);if(E<this.options.sliderMinHeight){E=this.options.sliderMinHeight}else{if((this.options.sliderMaxHeight!=null)&&E>this.options.sliderMaxHeight){E=this.options.sliderMaxHeight}}if(A===r&&H.overflowX!==r){E+=l}this.maxSliderTop=D-E;this.contentHeight=G;this.paneHeight=z;this.paneOuterHeight=D;this.sliderHeight=E;this.slider.height(E);this.events.scroll();this.pane.show();this.isActive=true;if((F.scrollHeight===F.clientHeight)||(this.pane.outerHeight(true)>=F.scrollHeight&&A!==r)){this.pane.hide();this.isActive=false}else{if(this.el.clientHeight===F.scrollHeight&&A===r){this.slider.hide()}else{this.slider.show()}}this.pane.css({opacity:(this.options.alwaysVisible?1:""),visibility:(this.options.alwaysVisible?"visible":"")});return this};y.prototype.scroll=function(){if(!this.isActive){return}this.sliderY=Math.max(0,this.sliderY);this.sliderY=Math.min(this.maxSliderTop,this.sliderY);this.$content.scrollTop((this.paneHeight-this.contentHeight+l)*this.sliderY/this.maxSliderTop*-1);if(!this.iOSNativeScrolling){this.slider.css({top:this.sliderY})}return this};y.prototype.scrollBottom=function(z){if(!this.isActive){return}this.reset();this.$content.scrollTop(this.contentHeight-this.$content.height()-z).trigger(w);return this};y.prototype.scrollTop=function(z){if(!this.isActive){return}this.reset();this.$content.scrollTop(+z).trigger(w);return this};y.prototype.scrollTo=function(z){if(!this.isActive){return}this.reset();this.scrollTop(g(z).get(0).offsetTop);return this};y.prototype.stop=function(){this.stopped=true;this.removeEvents();this.pane.hide();return this};y.prototype.flash=function(){var z=this;if(!this.isActive){return}this.reset();this.pane.addClass("flashed");setTimeout(function(){z.pane.removeClass("flashed")},this.options.flashDelay);return this};return y})();g.fn.nanoScroller=function(y){return this.each(function(){var z,A;if(!(A=this.nanoscroller)){z=g.extend({},o,y);this.nanoscroller=A=new x(this,z)}if(y&&typeof y==="object"){g.extend(A.options,y);if(y.scrollBottom){return A.scrollBottom(y.scrollBottom)}if(y.scrollTop){return A.scrollTop(y.scrollTop)}if(y.scrollTo){return A.scrollTo(y.scrollTo)}if(y.scroll==="bottom"){return A.scrollBottom(0)}if(y.scroll==="top"){return A.scrollTop(0)}if(y.scroll&&y.scroll instanceof g){return A.scrollTo(y.scroll)}if(y.stop){return A.stop()}if(y.flash){return A.flash()}}return A.reset()})}})(jQuery,window,document);